import{e as w,a as M}from"./platform-BknMeRIZ.js";import{r as c}from"./index-Dy2Ak0OH.js";import{$ as k}from"./SSRProvider-CmMeNDTG.js";import{c as H,a as P}from"./mergeProps-VNdaC4-V.js";const E=e=>{var n;return(n=e==null?void 0:e.ownerDocument)!==null&&n!==void 0?n:document},l=e=>e&&"window"in e&&e.window===e?e:E(e).defaultView||window;function W(e){return e.mozInputSource===0&&e.isTrusted?!0:w()&&e.pointerType?e.type==="click"&&e.buttons===1:e.detail===0&&!e.pointerType}function z(e){return!w()&&e.width===0&&e.height===0||e.width===1&&e.height===1&&e.pressure===0&&e.detail===0&&e.pointerType==="mouse"}class S{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(n,t){this.nativeEvent=t,this.target=t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget,this.bubbles=t.bubbles,this.cancelable=t.cancelable,this.defaultPrevented=t.defaultPrevented,this.eventPhase=t.eventPhase,this.isTrusted=t.isTrusted,this.timeStamp=t.timeStamp,this.type=n}}function C(e){let n=c.useRef({isFocused:!1,observer:null});H(()=>{const r=n.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]);let t=P(r=>{e==null||e(r)});return c.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){n.current.isFocused=!0;let o=r.target,i=u=>{n.current.isFocused=!1,o.disabled&&t(new S("blur",u)),n.current.observer&&(n.current.observer.disconnect(),n.current.observer=null)};o.addEventListener("focusout",i,{once:!0}),n.current.observer=new MutationObserver(()=>{if(n.current.isFocused&&o.disabled){var u;(u=n.current.observer)===null||u===void 0||u.disconnect();let d=o===document.activeElement?null:document.activeElement;o.dispatchEvent(new FocusEvent("blur",{relatedTarget:d})),o.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:d}))}}),n.current.observer.observe(o,{attributes:!0,attributeFilter:["disabled"]})}},[t])}let s=null,$=new Set,v=new Map,b=!1,g=!1;const I={Tab:!0,Escape:!0};function h(e,n){for(let t of $)t(e,n)}function B(e){return!(e.metaKey||!M()&&e.altKey||e.ctrlKey||e.key==="Control"||e.key==="Shift"||e.key==="Meta")}function p(e){b=!0,B(e)&&(s="keyboard",h("keyboard",e))}function a(e){s="pointer",(e.type==="mousedown"||e.type==="pointerdown")&&(b=!0,h("pointer",e))}function y(e){W(e)&&(b=!0,s="virtual")}function L(e){e.target===window||e.target===document||(!b&&!g&&(s="virtual",h("virtual",e)),b=!1,g=!1)}function T(){b=!1,g=!0}function m(e){if(typeof window>"u"||v.get(l(e)))return;const n=l(e),t=E(e);let r=n.HTMLElement.prototype.focus;n.HTMLElement.prototype.focus=function(){b=!0,r.apply(this,arguments)},t.addEventListener("keydown",p,!0),t.addEventListener("keyup",p,!0),t.addEventListener("click",y,!0),n.addEventListener("focus",L,!0),n.addEventListener("blur",T,!1),typeof PointerEvent<"u"?(t.addEventListener("pointerdown",a,!0),t.addEventListener("pointermove",a,!0),t.addEventListener("pointerup",a,!0)):(t.addEventListener("mousedown",a,!0),t.addEventListener("mousemove",a,!0),t.addEventListener("mouseup",a,!0)),n.addEventListener("beforeunload",()=>{x(e)},{once:!0}),v.set(n,{focus:r})}const x=(e,n)=>{const t=l(e),r=E(e);n&&r.removeEventListener("DOMContentLoaded",n),v.has(t)&&(t.HTMLElement.prototype.focus=v.get(t).focus,r.removeEventListener("keydown",p,!0),r.removeEventListener("keyup",p,!0),r.removeEventListener("click",y,!0),t.removeEventListener("focus",L,!0),t.removeEventListener("blur",T,!1),typeof PointerEvent<"u"?(r.removeEventListener("pointerdown",a,!0),r.removeEventListener("pointermove",a,!0),r.removeEventListener("pointerup",a,!0)):(r.removeEventListener("mousedown",a,!0),r.removeEventListener("mousemove",a,!0),r.removeEventListener("mouseup",a,!0)),v.delete(t))};function D(e){const n=E(e);let t;return n.readyState!=="loading"?m(e):(t=()=>{m(e)},n.addEventListener("DOMContentLoaded",t)),()=>x(e,t)}typeof document<"u"&&D();function K(){return s!=="pointer"}function G(){return s}function N(e){s=e,h(e,null)}function Y(){m();let[e,n]=c.useState(s);return c.useEffect(()=>{let t=()=>{n(s)};return $.add(t),()=>{$.delete(t)}},[]),k()?null:e}const O=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function j(e,n,t){var r;const o=typeof window<"u"?l(t==null?void 0:t.target).HTMLInputElement:HTMLInputElement,i=typeof window<"u"?l(t==null?void 0:t.target).HTMLTextAreaElement:HTMLTextAreaElement,u=typeof window<"u"?l(t==null?void 0:t.target).HTMLElement:HTMLElement,d=typeof window<"u"?l(t==null?void 0:t.target).KeyboardEvent:KeyboardEvent;return e=e||(t==null?void 0:t.target)instanceof o&&!O.has(t==null||(r=t.target)===null||r===void 0?void 0:r.type)||(t==null?void 0:t.target)instanceof i||(t==null?void 0:t.target)instanceof u&&(t==null?void 0:t.target.isContentEditable),!(e&&n==="keyboard"&&t instanceof d&&!I[t.key])}function _(e,n,t){m(),c.useEffect(()=>{let r=(o,i)=>{j(!!(t!=null&&t.isTextInput),o,i)&&e(K())};return $.add(r),()=>{$.delete(r)}},n)}function q(e){let{isDisabled:n,onBlurWithin:t,onFocusWithin:r,onFocusWithinChange:o}=e,i=c.useRef({isFocusWithin:!1}),u=c.useCallback(f=>{i.current.isFocusWithin&&!f.currentTarget.contains(f.relatedTarget)&&(i.current.isFocusWithin=!1,t&&t(f),o&&o(!1))},[t,o,i]),d=C(u),F=c.useCallback(f=>{!i.current.isFocusWithin&&document.activeElement===f.target&&(r&&r(f),o&&o(!0),i.current.isFocusWithin=!0,d(f))},[r,o,d]);return n?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:F,onBlur:u}}}export{E as $,G as a,N as b,q as c,C as d,K as e,_ as f,l as g,Y as h,z as i,W as j};
