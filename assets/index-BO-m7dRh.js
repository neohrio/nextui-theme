import{r as i}from"./index-Dy2Ak0OH.js";import{u as b}from"./index-BZiajwfa.js";function z(S={}){const{loading:a,src:r,srcSet:u,onLoad:s,onError:t,crossOrigin:c,sizes:l,ignoreFallback:f}=S,[d,g]=i.useState("pending");i.useEffect(()=>{g(r?"loading":"pending")},[r]);const n=i.useRef(),p=i.useCallback(()=>{if(!r)return;o();const e=new Image;e.src=r,c&&(e.crossOrigin=c),u&&(e.srcset=u),l&&(e.sizes=l),a&&(e.loading=a),e.onload=m=>{o(),g("loaded"),s==null||s(m)},e.onerror=m=>{o(),g("failed"),t==null||t(m)},n.current=e},[r,c,u,l,s,t,a]),o=()=>{n.current&&(n.current.onload=null,n.current.onerror=null,n.current=null)};return b(()=>{if(!f)return d==="loading"&&p(),()=>{o()}},[d,p,f]),f?"loaded":d}export{z as u};
