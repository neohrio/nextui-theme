import{c as Y,d as D,e as x}from"./usePress-BDQnv3aP.js";import{r as $}from"./index-Dy2Ak0OH.js";import{a as T}from"./mergeProps-VNdaC4-V.js";function G(X){let{onMoveStart:g,onMove:s,onMoveEnd:K}=X,o=$.useRef({didMove:!1,lastPosition:null,id:null}),{addGlobalListener:t,removeGlobalListener:u}=Y(),y=T((r,f,v,n)=>{v===0&&n===0||(o.current.didMove||(o.current.didMove=!0,g==null||g({type:"movestart",pointerType:f,shiftKey:r.shiftKey,metaKey:r.metaKey,ctrlKey:r.ctrlKey,altKey:r.altKey})),s==null||s({type:"move",pointerType:f,deltaX:v,deltaY:n,shiftKey:r.shiftKey,metaKey:r.metaKey,ctrlKey:r.ctrlKey,altKey:r.altKey}))}),m=T((r,f)=>{D(),o.current.didMove&&(K==null||K({type:"moveend",pointerType:f,shiftKey:r.shiftKey,metaKey:r.metaKey,ctrlKey:r.ctrlKey,altKey:r.altKey}))});return{moveProps:$.useMemo(()=>{let r={},f=()=>{x(),o.current.didMove=!1};if(typeof PointerEvent>"u"){let n=e=>{if(e.button===0){var a,p,l,w;y(e,"mouse",e.pageX-((l=(a=o.current.lastPosition)===null||a===void 0?void 0:a.pageX)!==null&&l!==void 0?l:0),e.pageY-((w=(p=o.current.lastPosition)===null||p===void 0?void 0:p.pageY)!==null&&w!==void 0?w:0)),o.current.lastPosition={pageX:e.pageX,pageY:e.pageY}}},c=e=>{e.button===0&&(m(e,"mouse"),u(window,"mousemove",n,!1),u(window,"mouseup",c,!1))};r.onMouseDown=e=>{e.button===0&&(f(),e.stopPropagation(),e.preventDefault(),o.current.lastPosition={pageX:e.pageX,pageY:e.pageY},t(window,"mousemove",n,!1),t(window,"mouseup",c,!1))};let d=e=>{let a=[...e.changedTouches].findIndex(({identifier:h})=>h===o.current.id);if(a>=0){var p,l;let{pageX:h,pageY:M}=e.changedTouches[a];var w,b;y(e,"touch",h-((w=(p=o.current.lastPosition)===null||p===void 0?void 0:p.pageX)!==null&&w!==void 0?w:0),M-((b=(l=o.current.lastPosition)===null||l===void 0?void 0:l.pageY)!==null&&b!==void 0?b:0)),o.current.lastPosition={pageX:h,pageY:M}}},i=e=>{[...e.changedTouches].findIndex(({identifier:p})=>p===o.current.id)>=0&&(m(e,"touch"),o.current.id=null,u(window,"touchmove",d),u(window,"touchend",i),u(window,"touchcancel",i))};r.onTouchStart=e=>{if(e.changedTouches.length===0||o.current.id!=null)return;let{pageX:a,pageY:p,identifier:l}=e.changedTouches[0];f(),e.stopPropagation(),e.preventDefault(),o.current.lastPosition={pageX:a,pageY:p},o.current.id=l,t(window,"touchmove",d,!1),t(window,"touchend",i,!1),t(window,"touchcancel",i,!1)}}else{let n=d=>{if(d.pointerId===o.current.id){var i,e;let l=d.pointerType||"mouse";var a,p;y(d,l,d.pageX-((a=(i=o.current.lastPosition)===null||i===void 0?void 0:i.pageX)!==null&&a!==void 0?a:0),d.pageY-((p=(e=o.current.lastPosition)===null||e===void 0?void 0:e.pageY)!==null&&p!==void 0?p:0)),o.current.lastPosition={pageX:d.pageX,pageY:d.pageY}}},c=d=>{if(d.pointerId===o.current.id){let i=d.pointerType||"mouse";m(d,i),o.current.id=null,u(window,"pointermove",n,!1),u(window,"pointerup",c,!1),u(window,"pointercancel",c,!1)}};r.onPointerDown=d=>{d.button===0&&o.current.id==null&&(f(),d.stopPropagation(),d.preventDefault(),o.current.lastPosition={pageX:d.pageX,pageY:d.pageY},o.current.id=d.pointerId,t(window,"pointermove",n,!1),t(window,"pointerup",c,!1),t(window,"pointercancel",c,!1))}}let v=(n,c,d)=>{f(),y(n,"keyboard",c,d),m(n,"keyboard")};return r.onKeyDown=n=>{switch(n.key){case"Left":case"ArrowLeft":n.preventDefault(),n.stopPropagation(),v(n,-1,0);break;case"Right":case"ArrowRight":n.preventDefault(),n.stopPropagation(),v(n,1,0);break;case"Up":case"ArrowUp":n.preventDefault(),n.stopPropagation(),v(n,0,-1);break;case"Down":case"ArrowDown":n.preventDefault(),n.stopPropagation(),v(n,0,1);break}},r},[o,t,u,y,m])}}export{G as $};
